<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="description" content="Project by Michael Abia">
        <meta name="keywords" content="Javascript, Game, Engine, Michael Abia, Jaeger Engine">
        <meta content="https://twitter.com/michael_abia_v1" property="og:see_also" />
		<!-- Twitter data -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@michael_abia_v1" />
		<meta name="twitter:creator" content="@michael_abia_v1" />
		<meta name="twitter:title" content="Jaeger Engine" />
		<meta name="twitter:description" content="a javascript game engine" />
		<meta name="twitter:image" content="https://jaeger-engine.web.app/assets/jaeger-engine.png" />
		<meta name="twitter:image:width" content="315" />
		<meta name="twitter:image:height" content="600" />
		<meta name="twitter:image:alt" content="Brinmo" />
        <meta property="og:title" content="Jaeger Engine">
        <meta property="og:type" content="Website">
        <meta property="og:url" content="https://jaeger-engine.web.app">
        <meta property="og:image:width" content="315">
        <meta property="og:image:height" content="600">
        <meta property="og:image:alt" content="Jaeger Engine">
        <meta property="og:image:secure_url" content="https://jaeger-engine.web.app/assets/jaeger-engine.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:site_name" content="Jaeger-Engine">
        <link rel="icon" type="image/png" href="../assets/favicon-32x32.png" sizes="32x32">
        <link rel="stylesheet" href="../assets/main.css"/>
        <script src="../codemirror/lib/codemirror.js"></script>
        <link rel="stylesheet" href="../codemirror/addon/fold/foldgutter.css">
        <link rel="stylesheet" href="../codemirror/addon/dialog/dialog.css">
        <link rel="stylesheet" href="../codemirror/addon/scroll/simplescrollbars.css">
        <link rel="stylesheet" href="../codemirror/theme/monokai.css">
        <link rel="stylesheet" href="../codemirror/lib/codemirror.css">
        <script src="../codemirror/addon/search/searchcursor.js"></script>
        <script src="../codemirror/addon/search/search.js"></script>
        <script src="../codemirror/addon/dialog/dialog.js"></script>
        <script src="../codemirror/addon/edit/matchbrackets.js"></script>
        <script src="../codemirror/addon/edit/closebrackets.js"></script>
        <script src="../codemirror/addon/comment/comment.js"></script>
        <script src="../codemirror/addon/wrap/hardwrap.js"></script>
        <script src="../codemirror/addon/fold/foldcode.js"></script>
        <script src="../codemirror/addon/fold/brace-fold.js"></script>
        <script src="../codemirror/addon/scroll/simplescrollbars.js"></script>
        <script src="../codemirror/mode/javascript/javascript.js"></script>
        <script src="../2d/game_engine.js"></script>
        <script src="../2d/game_editor.js"></script>
        <title>Jaeger Engine</title>
    </head>
    <body>
        <section>
            <div id="nocode">
                <canvas id="screen"></canvas>
                <div id="menu">
                    <button id="compile" onclick="compileCode()">üîÉ Compile</button>
                    <button id="togglegame" onclick="toggleGame()">‚ñ∂Ô∏è Play</button>
                    <button onclick="togglePositions()">‚ñ¶ Grid</button>
                    <button onclick="toggleFPS()">‚åó FPS</button>
                    <button onclick="importGame()">üìÅ Import</button>
                    <button onclick="exportGame()">üéÆ Export</button>
                </div>
                <div id="charactermenu">
                    <div class="list">
                    </div>
                    <div id="type">
                        <div style="color: antiquewhite; font-weight: bold; font-family: sans-serif;">Add Character: </div>
                        &nbsp;&nbsp;&nbsp;
                        <button onclick="createCharacter('b')">Background</button>
                        <button onclick="createCharacter('c')">Collision</button>
                        <button onclick="createCharacter('n')">NPC</button>
                        <button onclick="createCharacter('p')">Player</button>
                    </div>
                </div>
                <div id="loopmenu">

                </div>
            </div>
            <div id="code">
                <div>
                    <button id="ct" onclick="openTab('characters.js')">Characters.js</button>
                    <button id="lt" onclick="openTab('loop.js')">Loop.js</button>
                    <button style="float: right; font-size: x-small; background-color: black;" onclick="deleteAll()">üóëÔ∏è Delete Project</button>
                </div>
                <div id="charactertab" oninput="saveTab('characters.js')"></div>
                <div id="looptab" oninput="saveTab('loop.js')"></div>
                <div id="pdetails" style="color: orangered;"></div>
            </div>
        </section>
        <div id="popup">
        </div>
        <div id="stat">
        </div>
    </body>
    <script defer>
        var loopeditor = CodeMirror(document.getElementById('looptab'), {
            mode:  "javascript",
            lineNumbers: true,
            theme: 'monokai',
            lineWrapping: false,
            tabSize: 4,
            scrollbarStyle: 'overlay'
        });
        var characterseditor = CodeMirror(document.getElementById('charactertab'), {
            mode:  "javascript",
            lineNumbers: true,
            theme: 'monokai',
            lineWrapping: false,
            tabSize: 4,
            scrollbarStyle: 'overlay'
        });

        //get the project name from the searchparams
        let pparams = (new URL(document.location)).searchParams;
        let pname = pparams.get('name');
        if (pname != null && pname != "") {
            Game.name = pname.replaceAll(' ', '_');
            window.title = "Jaeger Engine - " + Game.name;
            document.title = "Jaeger Engine - " + Game.name;
            //check if project exists in memory
            const exists = localStorage.getItem(Game.name+"_ct");
            if(exists){
                openTab('loop.js');
                openTab('characters.js');
                window.eval(characterseditor.getDoc().getValue());
                window.eval(loopeditor.getDoc().getValue());
            } else {
                localStorage[Game.name] = "2d";
                saveTab('characters.js');
                saveTab('loop.js');
                openTab('loop.js');
                openTab('characters.js');
            }
            document.getElementById("pdetails").innerText = ":: 2D/" + Game.name;
        } else {
            Game.name = "project_"+Math.floor(Math.random()*10000);
            window.location.replace("?name="+Game.name);
        }
    </script>
</html>